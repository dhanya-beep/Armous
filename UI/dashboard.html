<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Supervisor Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 24px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-content h1 {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .header-content p {
            color: #94a3b8;
        }

        .refresh-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #475569;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
        }

        .refresh-btn:hover {
            background: #64748b;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 24px;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .stat-label {
            color: #94a3b8;
            font-size: 14px;
            font-weight: 500;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-top: 8px;
        }

        .stat-icon {
            font-size: 28px;
            opacity: 0.8;
        }

        .stat-bar {
            height: 4px;
            background: #334155;
            border-radius: 9999px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            border-radius: 9999px;
            width: 75%;
        }

        .stat-bar-red .stat-bar-fill { background: #dc2626; }
        .stat-bar-yellow .stat-bar-fill { background: #eab308; }
        .stat-bar-green .stat-bar-fill { background: #16a34a; }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Panel */
        .panel {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 12px;
            padding: 24px;
        }

        .panel-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 16px;
            font-size: 20px;
            font-weight: bold;
        }

        /* Alerts List */
        .alerts-list {
            max-height: 400px;
            overflow-y: auto;
            space-y: 12px;
        }

        .alert-item {
            border: 2px solid #334155;
            border-radius: 8px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 12px;
        }

        .alert-item:hover {
            border-color: #3b82f6;
        }

        .alert-item.selected {
            border-color: #3b82f6;
            background: #1e3a8a;
        }

        .alert-item.threat-high {
            background: #7f1d1d;
            border-color: #991b1b;
        }

        .alert-item.threat-medium {
            background: #78350f;
            border-color: #92400e;
        }

        .alert-item.threat-low {
            background: #052e16;
            border-color: #166534;
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .alert-ip {
            font-weight: 600;
            font-size: 16px;
        }

        .alert-threat {
            font-size: 14px;
            color: #cbd5e1;
        }

        .alert-score {
            font-weight: bold;
            font-size: 24px;
        }

        .alert-score.score-high { color: #ef4444; }
        .alert-score.score-medium { color: #f59e0b; }
        .alert-score.score-low { color: #10b981; }

        .alert-time {
            font-size: 12px;
            color: #64748b;
        }

        .alerts-empty {
            text-align: center;
            color: #94a3b8;
            padding: 32px;
        }

        /* Alert Details */
        .details-box {
            background: #0f172a;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            space-y: 12px;
        }

        .detail-row {
            margin-bottom: 12px;
        }

        .detail-label {
            color: #94a3b8;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-weight: 500;
            margin-top: 4px;
            word-break: break-all;
        }

        .detail-value.mono {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            background: #1e293b;
            padding: 8px;
            border-radius: 4px;
            margin-top: 4px;
        }

        .risk-bar {
            width: 100%;
            height: 8px;
            background: #334155;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .risk-bar-fill {
            height: 100%;
            transition: width 0.3s;
        }

        .risk-bar-low .risk-bar-fill { background: #10b981; width: 30%; }
        .risk-bar-medium .risk-bar-fill { background: #f59e0b; width: 60%; }
        .risk-bar-high .risk-bar-fill { background: #ef4444; width: 90%; }

        /* Action Buttons */
        .action-buttons {
            space-y: 8px;
        }

        .action-title {
            font-size: 12px;
            font-weight: 600;
            color: #cbd5e1;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .action-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .action-btn-allow {
            background: #16a34a;
            color: white;
        }

        .action-btn-allow:hover {
            background: #15803d;
        }

        .action-btn-challenge {
            background: #eab308;
            color: black;
        }

        .action-btn-challenge:hover {
            background: #ca8a04;
        }

        .action-btn-block {
            background: #dc2626;
            color: white;
        }

        .action-btn-block:hover {
            background: #b91c1c;
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* History Table */
        .history-section {
            margin-top: 24px;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .history-table thead {
            border-bottom: 1px solid #334155;
        }

        .history-table th {
            text-align: left;
            padding: 12px 16px;
            color: #94a3b8;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .history-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #334155;
        }

        .history-table tbody tr:hover {
            background: #334155;
        }

        .time-cell {
            color: #94a3b8;
            font-family: 'Courier New', monospace;
        }

        .ip-cell {
            font-family: 'Courier New', monospace;
        }

        .action-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
        }

        .action-badge-allow {
            background: #052e16;
            color: #86efac;
        }

        .action-badge-challenge {
            background: #78350f;
            color: #fcd34d;
        }

        .action-badge-block {
            background: #7f1d1d;
            color: #fca5a5;
        }

        .reason-cell {
            color: #cbd5e1;
        }

        .no-alerts {
            text-align: center;
            padding: 32px;
            color: #94a3b8;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #334155;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: #64748b;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <h1>Security Dashboard</h1>
                <p>Real-time threat monitoring & supervisor actions</p>
            </div>
            <button class="refresh-btn" onclick="location.reload()">
                🔄 Refresh
            </button>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-label">Active Alerts</div>
                        <div class="stat-value" id="stat-alerts">3</div>
                    </div>
                    <div class="stat-icon">🚨</div>
                </div>
                <div class="stat-bar stat-bar-red">
                    <div class="stat-bar-fill"></div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-label">Blocked Today</div>
                        <div class="stat-value">24</div>
                    </div>
                    <div class="stat-icon">🔴</div>
                </div>
                <div class="stat-bar stat-bar-red">
                    <div class="stat-bar-fill"></div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-label">Challenged</div>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-icon">🟡</div>
                </div>
                <div class="stat-bar stat-bar-yellow">
                    <div class="stat-bar-fill"></div>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-header">
                    <div>
                        <div class="stat-label">Allowed</div>
                        <div class="stat-value">156</div>
                    </div>
                    <div class="stat-icon">🟢</div>
                </div>
                <div class="stat-bar stat-bar-green">
                    <div class="stat-bar-fill"></div>
                </div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Active Alerts -->
            <div class="panel">
                <div class="panel-header">
                    🚨 Active Alerts (<span id="alert-count">3</span>)
                </div>
                <div class="alerts-list" id="alerts-list"></div>
            </div>

            <!-- Alert Details & Actions -->
            <div class="panel">
                <div class="panel-header">Threat Details</div>
                <div id="details-panel">
                    <div class="no-alerts">No alerts to review</div>
                </div>
            </div>
        </div>

        <!-- Action History -->
        <div class="panel history-section">
            <div class="panel-header">📊 Recent Actions</div>
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>IP Address</th>
                        <th>Action</th>
                        <th>Reason</th>
                    </tr>
                </thead>
                <tbody id="history-tbody">
                    <tr>
                        <td class="time-cell">14:25:30</td>
                        <td class="ip-cell">192.168.1.100</td>
                        <td><span class="action-badge action-badge-block">🔴 BLOCK</span></td>
                        <td class="reason-cell">Known malicious</td>
                    </tr>
                    <tr>
                        <td class="time-cell">14:20:15</td>
                        <td class="ip-cell">198.51.100.50</td>
                        <td><span class="action-badge action-badge-allow">🟢 ALLOW</span></td>
                        <td class="reason-cell">Safe browsing</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Alert Data
        let alerts = [
            { id: 1, ip: '185.220.101.32', threat: 'Tor Exit Node', score: 12, ua: 'python-requests/2.28.1', timestamp: '2025-10-14 14:32:15' },
            { id: 2, ip: '203.0.113.45', threat: 'High Rate Limiting', score: 8, ua: 'Mozilla/5.0 Chrome', timestamp: '2025-10-14 14:31:42' },
            { id: 3, ip: '198.51.100.12', threat: 'Suspicious JA3', score: 5, ua: 'curl/7.68.0', timestamp: '2025-10-14 14:30:05' },
        ];

        let selectedAlert = alerts[0];
        let actionHistory = [
            { action: 'BLOCK', ip: '192.168.1.100', reason: 'Known malicious', time: '14:25:30' },
            { action: 'ALLOW', ip: '198.51.100.50', reason: 'Safe browsing', time: '14:20:15' },
        ];

        function getThreatClass(score) {
            if (score >= 8) return 'threat-high';
            if (score >= 5) return 'threat-medium';
            return 'threat-low';
        }

        function getScoreClass(score) {
            if (score >= 8) return 'score-high';
            if (score >= 5) return 'score-medium';
            return 'score-low';
        }

        function getRiskBarClass(score) {
            if (score >= 8) return 'risk-bar-high';
            if (score >= 5) return 'risk-bar-medium';
            return 'risk-bar-low';
        }

        function renderAlerts() {
            const listEl = document.getElementById('alerts-list');
            if (alerts.length === 0) {
                listEl.innerHTML = '<div class="alerts-empty">All clear! No active threats.</div>';
                return;
            }

            listEl.innerHTML = alerts.map(alert => `
                <div class="alert-item ${getThreatClass(alert.score)} ${selectedAlert?.id === alert.id ? 'selected' : ''}" 
                     onclick="selectAlert(${alert.id})">
                    <div class="alert-header">
                        <div>
                            <div class="alert-ip">${alert.ip}</div>
                            <div class="alert-threat">${alert.threat}</div>
                        </div>
                        <div class="alert-score ${getScoreClass(alert.score)}">${alert.score}</div>
                    </div>
                    <div class="alert-time">${alert.timestamp}</div>
                </div>
            `).join('');

            document.getElementById('alert-count').textContent = alerts.length;
            document.getElementById('stat-alerts').textContent = alerts.length;
        }

        function selectAlert(id) {
            selectedAlert = alerts.find(a => a.id === id);
            renderAlerts();
            renderDetails();
        }

        function renderDetails() {
            const detailsPanel = document.getElementById('details-panel');
            if (!selectedAlert) {
                detailsPanel.innerHTML = '<div class="no-alerts">No alerts to review</div>';
                return;
            }

            detailsPanel.innerHTML = `
                <div class="details-box">
                    <div class="detail-row">
                        <div class="detail-label">IP Address</div>
                        <div class="detail-value">${selectedAlert.ip}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Threat Type</div>
                        <div class="detail-value">${selectedAlert.threat}</div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">Risk Score</div>
                        <div style="display: flex; align-items: center; gap: 8px; margin-top: 4px;">
                            <div class="risk-bar ${getRiskBarClass(selectedAlert.score)}" style="flex: 1;">
                                <div class="risk-bar-fill"></div>
                            </div>
                            <span style="font-weight: bold;">${selectedAlert.score}/10</span>
                        </div>
                    </div>
                    <div class="detail-row">
                        <div class="detail-label">User Agent</div>
                        <div class="detail-value mono">${selectedAlert.ua}</div>
                    </div>
                </div>

                <div class="action-title">Take Action</div>
                <div class="action-buttons">
                    <button class="action-btn action-btn-allow" onclick="takeAction('ALLOW')">
                        🟢 ALLOW
                    </button>
                    <button class="action-btn action-btn-challenge" onclick="takeAction('CHALLENGE')">
                        🟡 CHALLENGE
                    </button>
                    <button class="action-btn action-btn-block" onclick="takeAction('BLOCK')">
                        🔴 BLOCK
                    </button>
                </div>
            `;
        }

        function takeAction(action) {
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            actionHistory.unshift({
                action: action,
                ip: selectedAlert.ip,
                reason: `Manual ${action}`,
                time: time
            });

            alerts = alerts.filter(a => a.id !== selectedAlert.id);
            selectedAlert = alerts[0] || null;

            renderAlerts();
            renderDetails();
            renderHistory();

            alert(`✓ Action: ${action} applied to ${selectedAlert?.ip || 'alert'}`);
        }

        function renderHistory() {
            const tbody = document.getElementById('history-tbody');
            tbody.innerHTML = actionHistory.map(entry => `
                <tr>
                    <td class="time-cell">${entry.time}</td>
                    <td class="ip-cell">${entry.ip}</td>
                    <td>
                        <span class="action-badge action-badge-${entry.action.toLowerCase()}">
                            ${entry.action === 'BLOCK' ? '🔴' : entry.action === 'CHALLENGE' ? '🟡' : '🟢'} ${entry.action}
                        </span>
                    </td>
                    <td class="reason-cell">${entry.reason}</td>
                </tr>
            `).join('');
        }

        // Initialize
        renderAlerts();
        renderDetails();
        renderHistory();
    </script>
</body>
</html>
